// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`ServiceGenerator - Comprehensive Tests > Snapshot Testing > should match minimal snapshot structure 1`] = `
[
  {
    "filename": "post.service.ts",
    "snapshot": {
      "exports": [
        "postService",
      ],
      "functions": [
        "count",
        "postService",
      ],
      "imports": [
        "@/db",
        "@gen/contracts/post",
        "@prisma/client",
      ],
      "types": [],
    },
  },
]
`;

exports[`ServiceGenerator - Comprehensive Tests > Snapshot Testing > should match service snapshot 1`] = `
"// @generated
// This file is automatically generated. Do not edit manually.

import prisma from '@/db'
import type { TodoCreateDTO, TodoUpdateDTO, TodoQueryDTO } from '@gen/contracts/todo'
import type { Prisma } from '@prisma/client'


export const todoService = {
  /**
   * List Todo records with pagination
   */
  async list(query: TodoQueryDTO) {
    const { skip = 0, take = 20, orderBy, where, include, select } = query

    const [items, total] = await Promise.all([
      prisma.todo.findMany({
        skip,
        take,
        orderBy: orderBy as Prisma.TodoOrderByWithRelationInput,
        where: where as Prisma.TodoWhereInput,
        include: include as Prisma.TodoInclude | undefined,
        select: select as Prisma.TodoSelect | undefined,
      }),
      prisma.todo.count({
        where: where as Prisma.TodoWhereInput,
      })
    ])

    return {
      data: items,
      meta: {
        total,
        skip,
        take,
        hasMore: skip + take < total
      }
    }
  },

  /**
   * Find Todo by ID
   */
  async findById(id: number) {
    return prisma.todo.findUnique({
      where: { id }
    })
  },

  /**
   * Create Todo
   */
  async create(data: TodoCreateDTO) {
    return prisma.todo.create({
      data
    })
  },

  /**
   * Update Todo
   */
  async update(id: number, data: TodoUpdateDTO) {
    try {
      return await prisma.todo.update({
        where: { id },
        data
      })
    } catch (error: any) {
      if (error.code === 'P2025') {
        return null  // Not found
      }
      throw error
    }
  },

  /**
   * Delete Todo
   */
  async delete(id: number) {
    try {
      await prisma.todo.delete({
        where: { id }
      })
      return true
    } catch (error: any) {
      if (error.code === 'P2025') {
        return false  // Not found
      }
      throw error
    }
  },

  /**
   * Count Todo records
   */
  async count(where?: Prisma.TodoWhereInput) {
    return prisma.todo.count({ where })
  },

  /**
   * Check if Todo exists
   */
  async exists(id: number) {
    const count = await prisma.todo.count({
      where: { id }
    })
    return count > 0
  }
}"
`;
